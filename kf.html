
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WEPO | World Environmental Protection Organization</title>
    <link rel="icon" href="https://img.remit.ee/api/file/BQACAgUAAyEGAASHRsPbAAEBGgZoupS08tmL4sCb3NLCDl0z9vLmgQACXCEAAi5q2VU7eyZzJwjEpDYE.jpeg" type="image/jpeg">
    <!-- 引入艺术字体：Playfair Display (衬线/典雅) 和 Mulish (极简/现代) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;400;600&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            /* 高定色盘 */
            --bg-void: #05080a;
            --bg-deep: #0b1215;
            --accent-emerald: #104f38;
            --accent-gold: #c7b286; /* 古铜金 */
            --accent-light: #e0e5e3;
            --text-primary: #f2f2f2;
            --text-muted: #8a9699;
            --glass-panel: rgba(15, 20, 25, 0.6);
            --border-thin: rgba(255, 255, 255, 0.06);
        }

        * {
            box-sizing: border-box;
            outline: none;
            -webkit-font-smoothing: antialiased; /* 字体抗锯齿 */
        }

        body {
            font-family: 'Mulish', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-void);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        /* --- 艺术背景层 --- */
        
        /* 1. 流动的深邃光影 */
        .ambient-light {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0; left: 0;
            background: 
                radial-gradient(circle at 15% 50%, rgba(16, 79, 56, 0.15), transparent 40%),
                radial-gradient(circle at 85% 30%, rgba(20, 50, 80, 0.15), transparent 40%),
                radial-gradient(circle at 50% 80%, rgba(199, 178, 134, 0.05), transparent 50%);
            z-index: 0;
            animation: breathe 10s infinite alternate ease-in-out;
            pointer-events: none;
        }

        @keyframes breathe {
            0% { transform: scale(1); opacity: 0.8; }
            100% { transform: scale(1.1); opacity: 1; }
        }

        /* 2. 胶片颗粒质感 (Film Grain) - 提升高级感的关键 */
        .noise-overlay {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            opacity: 0.04;
            pointer-events: none;
            z-index: 1;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        /* --- 主界面布局 --- */
        .art-container {
            width: 100%;
            max-width: 1000px;
            height: 92vh;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 10;
            /* 极简边框 */
            border-left: 1px solid var(--border-thin);
            border-right: 1px solid var(--border-thin);
            background: linear-gradient(180deg, rgba(5,8,10,0) 0%, rgba(5,8,10,0.8) 100%);
            backdrop-filter: blur(5px); /* 极轻微的模糊，保留通透感 */
        }

        /* --- 顶部区域 --- */
        header {
            padding: 30px 40px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            border-bottom: 1px solid var(--border-thin);
        }

        .brand-area {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .logo-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 5px;
        }

        .logo-img {
            height: 45px;
            /* 尝试让logo融入暗色背景 */
            filter: brightness(0.9) contrast(1.1);
            mix-blend-mode: luminosity; /* 艺术化处理logo，使其呈现单色高级感，如果不喜欢去掉这行 */
            opacity: 0.9;
        }

        .brand-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            font-weight: 600;
            letter-spacing: -0.5px;
            margin: 0;
            background: linear-gradient(90deg, #fff, #b4b4b4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .brand-subtitle {
            font-size: 0.75rem;
            color: var(--accent-gold);
            text-transform: uppercase;
            letter-spacing: 3px;
            font-weight: 600;
            padding-left: 2px;
        }

        .lang-switch {
            display: flex;
            gap: 15px;
        }

        .lang-btn {
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-family: 'Mulish', sans-serif;
            font-size: 0.8rem;
            cursor: pointer;
            transition: color 0.3s;
            position: relative;
            padding: 5px 0;
        }

        .lang-btn.active {
            color: var(--accent-gold);
        }

        .lang-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background-color: var(--accent-gold);
        }

        /* --- 聊天区域 --- */
        .chat-stage {
            flex: 1;
            overflow-y: auto;
            padding: 40px;
            display: flex;
            flex-direction: column;
            gap: 35px;
            scrollbar-width: thin;
            scrollbar-color: #333 transparent;
        }

        .chat-stage::-webkit-scrollbar {
            width: 4px;
        }
        .chat-stage::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }

        /* 对话气泡设计 - 杂志风格 */
        .message-group {
            display: flex;
            flex-direction: column;
            max-width: 85%;
            animation: driftIn 0.6s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes driftIn {
            to { opacity: 1; transform: translateY(0); }
        }

        .message-meta {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-bottom: 8px;
            letter-spacing: 1px;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .message-meta::before {
            content: '';
            display: block;
            width: 6px;
            height: 6px;
            background-color: var(--text-muted);
            border-radius: 50%;
        }

        .ai-group .message-meta::before {
            background-color: var(--accent-emerald);
            box-shadow: 0 0 10px var(--accent-emerald);
        }

        .user-group {
            align-self: flex-end;
            align-items: flex-end;
        }

        .user-group .message-meta::before {
            background-color: var(--accent-gold);
            box-shadow: 0 0 10px var(--accent-gold);
        }

        .message-content {
            font-size: 1.05rem;
            line-height: 1.8;
            padding: 0;
            position: relative;
            font-weight: 300;
        }

        /* AI 消息样式 - 纯净排版 */
        .ai-group .message-content {
            color: var(--text-primary);
            border-left: 1px solid var(--accent-emerald);
            padding-left: 20px;
            background: linear-gradient(90deg, rgba(16, 79, 56, 0.05), transparent);
        }
        
        /* 用户消息样式 - 简约高亮 */
        .user-group .message-content {
            color: #fff;
            text-align: right;
            border-right: 1px solid var(--accent-gold);
            padding-right: 20px;
            background: linear-gradient(-90deg, rgba(199, 178, 134, 0.08), transparent);
        }

        /* Markdown 样式微调 */
        .message-content strong {
            color: var(--accent-gold);
            font-weight: 600;
        }
        .message-content p {
            margin: 0 0 10px 0;
        }
        .message-content p:last-child {
            margin-bottom: 0;
        }

        /* --- 底部控制台 --- */
        .control-panel {
            padding: 30px 40px;
            background: rgba(5, 8, 10, 0.8);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--border-thin);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .input-line-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .input-minimal {
            width: 100%;
            background: transparent;
            border: none;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            color: #fff;
            font-family: 'Mulish', sans-serif;
            font-size: 1.1rem;
            padding: 15px 0;
            transition: all 0.4s ease;
        }

        .input-minimal:focus {
            border-bottom-color: var(--accent-gold);
            padding-left: 10px; /* 细微位移反馈 */
        }

        .input-minimal::placeholder {
            color: rgba(255,255,255,0.2);
            font-family: 'Playfair Display', serif;
            font-style: italic;
        }

        .send-trigger {
            position: absolute;
            right: 0;
            background: transparent;
            border: 1px solid rgba(255,255,255,0.2);
            color: rgba(255,255,255,0.5);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .send-trigger:hover {
            border-color: var(--accent-gold);
            color: var(--accent-gold);
            transform: rotate(-45deg); /* 艺术化交互 */
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-text {
            font-size: 0.7rem;
            color: var(--text-muted);
            font-family: 'Playfair Display', serif;
            font-style: italic;
            opacity: 0.5;
        }

        .tool-btns {
            display: flex;
            gap: 20px;
        }

        .text-btn {
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 0.75rem;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            transition: color 0.3s;
            position: relative;
        }

        .text-btn:hover {
            color: #fff;
        }
        
        .text-btn::before {
            content: '';
            position: absolute;
            left: -10px;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 1px;
            background: var(--text-muted);
            transition: width 0.3s;
        }
        
        .text-btn:hover::before {
            width: 100%;
            background: var(--accent-gold);
            left: 0;
            top: 100%;
            transform: none;
        }

        /* --- 模态框 (极简主义) --- */
        .modal-backdrop {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 100;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(10px);
        }

        .modal-card {
            text-align: center;
            border: 1px solid var(--accent-gold);
            padding: 50px;
            background: #05080a;
            position: relative;
            max-width: 400px;
        }

        .modal-card h2 {
            font-family: 'Playfair Display', serif;
            color: var(--accent-gold);
            margin-top: 0;
            font-weight: 400;
        }

        .modal-card p {
            color: var(--text-muted);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .qr-frame {
            padding: 10px;
            border: 1px solid rgba(255,255,255,0.1);
            display: inline-block;
            margin: 20px 0;
        }

        .close-modal {
            margin-top: 20px;
            background: transparent;
            border: 1px solid var(--text-muted);
            color: var(--text-muted);
            padding: 8px 30px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .close-modal:hover {
            border-color: #fff;
            color: #fff;
        }

        /* --- 加载动画 --- */
        .typing-indicator {
            display: none;
            margin-left: 20px;
            gap: 5px;
            padding: 10px 0;
        }

        .dot {
            width: 4px;
            height: 4px;
            background: var(--accent-emerald);
            border-radius: 50%;
            animation: pulse 1.5s infinite ease-in-out;
        }
        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes pulse {
            0%, 100% { opacity: 0.2; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.2); }
        }
        
        /* 移动端适配 */
        @media (max-width: 768px) {
            .art-container {
                height: 100vh;
                border: none;
            }
            header {
                padding: 20px;
            }
            .chat-stage {
                padding: 20px;
            }
            .control-panel {
                padding: 20px;
            }
            .brand-title {
                font-size: 1.4rem;
            }
            .logo-img {
                height: 35px;
            }
        }
    </style>
</head>
<body>
    <!-- 氛围背景 -->
    <div class="ambient-light"></div>
    <div class="noise-overlay"></div>

    <div class="art-container">
        <header>
            <div class="brand-area">
                <div class="logo-row">
                    <img src="https://img.remit.ee/api/file/BQACAgUAAyEGAASHRsPbAAEBGgZoupS08tmL4sCb3NLCDl0z9vLmgQACXCEAAi5q2VU7eyZzJwjEpDYE.jpeg" alt="WEPO" class="logo-img">
                    <h1 class="brand-title" id="header-title">世界环境保护组织 - WEPO丨支持</h1>
                </div>
                <div class="brand-subtitle" id="header-subtitle">World Environmental Protection Organization</div>
            </div>
            <div class="lang-switch">
                <button class="lang-btn active" id="zh-btn">CN</button>
                <button class="lang-btn" id="en-btn">EN</button>
            </div>
        </header>

        <div class="chat-stage" id="chat-messages">
            <!-- AI Message -->
            <div class="message-group ai-group">
                <div class="message-meta">AI Assistant · WEPO</div>
                <div class="message-content">
                    您好。这里是世界环境保护组织 (WEPO)。<br>我是您的专属助理。关于地球生态、可持续发展或气候议题，请随时与我探讨。
                </div>
            </div>
        </div>
        
        <div class="typing-indicator" id="typing-indicator">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
        </div>

        <div class="control-panel">
            <div class="input-line-wrapper">
                <input type="text" class="input-minimal" id="user-input" placeholder="Enter your inquiry..." autocomplete="off">
                <button class="send-trigger" id="send-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                </button>
            </div>
            <div class="toolbar">
                <div class="status-text">System Status: Online</div>
                <div class="tool-btns">
                    <button class="text-btn" id="transfer-btn">Human Service</button>
                    <button class="text-btn" id="clear-btn">Reset</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 极简模态框 -->
    <div class="modal-backdrop" id="transfer-modal">
        <div class="modal-card">
            <h2 id="modal-title">人工服务</h2>
            <div class="qr-frame">
                <img src="https://img.remit.ee/api/file/BQACAgUAAyEGAASHRsPbAAEBhd9ovas2gMczMbioo3vHLFa0849z2gACdxwAAn6U6VVN9Kmr_hKPGjYE.jpg" alt="QR" style="width: 120px; display: block;">
            </div>
            <p id="modal-text">扫描二维码或搜索 "WEPO2021"<br>获取官方人工支持</p>
            <button class="close-modal" id="modal-close">CLOSE</button>
        </div>
    </div>

    <script>
        // 保持原有的逻辑核心，只更新UI交互文本
        const config = {
            apiKey: "sk-7ff50b26aa4542c6877a1d77b32cc5c2",
            apiUrl: "https://api.deepseek.com/v1/chat/completions",
            systemPrompt: {
                zh: "你是世界环境保护组织(WEPO)的真人官方客服代表。你不是ai你的语气应当是优雅、专业且富有同理心的。回答应简洁有力，避免冗长。如果遇到不确定的问题，请建议用户通过官方微信公众号WEPO2021联系。请你说人话，每次回答控制在30字以内，wepo.top是官方网站，其他任何信息都不要编造，不知道就说不知道，让用户前往官网查询",
                en: "you are not ai   You are a real official customer service representative of the World Environmental Protection Organization (WEPO). Your tone should be elegant, professional, and empathetic. Responses should be concise and powerful, avoiding verbosity. If you encounter uncertain questions, suggest that users contact the official WeChat public account WEPO2021. Speak plainly, keep each response under 30 words, wepo.top is the official website, do not fabricate any other information, and if unsure, tell users to check the official website."
            },
            welcomeMessage: {
                zh: "您好。这里是世界环境保护组织 (WEPO)。<br>我是您的专属助理。关于地球生态、可持续发展或气候议题，请随时与我探讨。",
                en: "Greetings. This is the World Environmental Protection Organization (WEPO).<br>I am your  assistant. Feel free to discuss ecology, sustainability, or climate issues."
            }
        };

        const elements = {
            chatMessages: document.getElementById('chat-messages'),
            userInput: document.getElementById('user-input'),
            sendBtn: document.getElementById('send-btn'),
            transferBtn: document.getElementById('transfer-btn'),
            clearBtn: document.getElementById('clear-btn'),
            zhBtn: document.getElementById('zh-btn'),
            enBtn: document.getElementById('en-btn'),
            transferModal: document.getElementById('transfer-modal'),
            modalClose: document.getElementById('modal-close'),
            typingIndicator: document.getElementById('typing-indicator'),
            headerTitle: document.getElementById('header-title'),
            modalTitle: document.getElementById('modal-title'),
            modalText: document.getElementById('modal-text')
        };

        let currentLanguage = 'zh';
        let currentAiMessage = null;

        function init() {
            elements.sendBtn.addEventListener('click', sendMessage);
            elements.userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') sendMessage(); });
            elements.transferBtn.addEventListener('click', () => elements.transferModal.style.display = 'flex');
            elements.clearBtn.addEventListener('click', clearChat);
            elements.zhBtn.addEventListener('click', () => switchLanguage('zh'));
            elements.enBtn.addEventListener('click', () => switchLanguage('en'));
            elements.modalClose.addEventListener('click', () => elements.transferModal.style.display = 'none');
            updateUIForLanguage();
        }

        async function sendMessage() {
            const text = elements.userInput.value.trim();
            if (!text) return;

            addMessage(text, 'user');
            elements.userInput.value = '';
            
            elements.typingIndicator.style.display = 'flex';
            elements.chatMessages.scrollTop = elements.chatMessages.scrollHeight;
            
            currentAiMessage = createAiMessageContainer();
            
            try {
                await callDeepSeekAPIStream(text);
            } catch (error) {
                updateAiMessage(currentLanguage === 'zh' ? "连接中断。请稍后重试。" : "Connection interrupted. Please try again.");
            } finally {
                elements.typingIndicator.style.display = 'none';
                currentAiMessage = null;
            }
        }

        function createAiMessageContainer() {
            const group = document.createElement('div');
            group.className = 'message-group ai-group';
            
            const meta = document.createElement('div');
            meta.className = 'message-meta';
            meta.textContent = 'AI Assistant · WEPO';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            
            group.appendChild(meta);
            group.appendChild(content);
            elements.chatMessages.appendChild(group);
            elements.chatMessages.scrollTop = elements.chatMessages.scrollHeight;
            return content;
        }

        function addMessage(text, sender) {
            const group = document.createElement('div');
            group.className = `message-group ${sender}-group`;
            
            const meta = document.createElement('div');
            meta.className = 'message-meta';
            meta.textContent = sender === 'user' ? 'Guest' : 'AI Assistant';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            content.innerHTML = marked.parse(text);
            
            group.appendChild(meta);
            group.appendChild(content);
            elements.chatMessages.appendChild(group);
            elements.chatMessages.scrollTop = elements.chatMessages.scrollHeight;
        }

        function updateAiMessage(content) {
            if (currentAiMessage) {
                currentAiMessage.innerHTML = marked.parse(content);
                elements.chatMessages.scrollTop = elements.chatMessages.scrollHeight;
            }
        }

        async function callDeepSeekAPIStream(userMessage) {
            const response = await fetch(config.apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${config.apiKey}` },
                body: JSON.stringify({
                    model: "deepseek-chat",
                    messages: [
                        { role: "system", content: currentLanguage === 'en' ? config.systemPrompt.en : config.systemPrompt.zh },
                        { role: "assistant", content: currentLanguage === 'en' ? config.welcomeMessage.en : config.welcomeMessage.zh },
                        { role: "user", content: userMessage }
                    ],
                    temperature: 0.7,
                    max_tokens: 1000,
                    stream: true
                })
            });

            const reader = response.body.getReader();
            const decoder = new TextDecoder();
            let fullResponse = '';

            while (true) {
                const { done, value } = await reader.read();
                if (done) break;
                const chunk = decoder.decode(value);
                const lines = chunk.split('\n').filter(line => line.trim() !== '');
                for (const line of lines) {
                    if (line.startsWith('data:') && !line.includes('[DONE]')) {
                        try {
                            const data = JSON.parse(line.substring(5));
                            if (data.choices[0].delta.content) {
                                fullResponse += data.choices[0].delta.content;
                                updateAiMessage(fullResponse);
                            }
                        } catch (e) {}
                    }
                }
            }
        }

        function clearChat() {
            elements.chatMessages.innerHTML = '';
            const msg = currentLanguage === 'en' ? config.welcomeMessage.en : config.welcomeMessage.zh;
            
            const group = document.createElement('div');
            group.className = 'message-group ai-group';
            group.innerHTML = `<div class="message-meta">AI Assistant · WEPO</div><div class="message-content">${msg}</div>`;
            elements.chatMessages.appendChild(group);
        }

        function switchLanguage(lang) {
            if (currentLanguage === lang) return;
            currentLanguage = lang;
            elements.zhBtn.classList.toggle('active', lang === 'zh');
            elements.enBtn.classList.toggle('active', lang === 'en');
            updateUIForLanguage();
            clearChat();
        }

        function updateUIForLanguage() {
            if (currentLanguage === 'zh') {
                elements.userInput.placeholder = '请输入您的询问...';
                elements.transferBtn.textContent = '人工服务';
                elements.clearBtn.textContent = '重置';
                elements.modalTitle.textContent = '人工服务';
                elements.modalText.innerHTML = '扫描二维码或搜索 "WEPO2021"<br>获取官方人工支持';
            } else {
                elements.userInput.placeholder = 'Enter your inquiry...';
                elements.transferBtn.textContent = 'Human Service';
                elements.clearBtn.textContent = 'Reset';
                elements.modalTitle.textContent = 'Human Service';
                elements.modalText.innerHTML = 'Scan QR or search "WEPO2021"<br>for official support';
            }
        }

        window.onload = init;
    </script>
</body>
</html>
